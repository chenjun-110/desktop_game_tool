<!DOCTYPE html>
<html ng-app="gameTool">
<head>
    <title>用户自定义</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>index</title>
    <link rel="stylesheet" type="text/css" href="../js/framework/bootstrap/3.0.2/bootstrap.min.css">

</head>
<body ng-controller="gameInitCtrl">
<nav class="navbar navbar-default" role="navigation">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
        <a class="navbar-brand" href="#">{{gameConfig.name}}</a>
      <a  class="btn btn-default navbar-btn pull-right" href="introduceGame.html?gameid={{gameConfig.gameid}}">
            版本介绍
        </a>
    </div>
</nav>
<!--
 item1
    role [    ]
    card [    ]
 item2
    role [    ]
    card [    ]
-->
<div class="roleChooser container" >
    <form class="form-horizontal" role="form" name="roleChooserForm">
        <div class="form-group ">
                <label for="maxPeople" class="col-xs-4 control-label">总人数</label>
                <div class="col-xs-offset-2 col-xs-3">
                    <input  type="number" required="required" class="form-control" name='maxPeople'  min="0" max="100" placeholder="人数" value="{{gameConfig.playerNum}}">
                </div>
                <span class="error" id="maxPeople" style="visibility: hidden">
                    error
                </span>

        </div>
        <div class="form-group" ng-repeat="role in gameConfig.roles" >
            <p>{{role.name}}</p>
            <div ng-repeat="properties in gameConfig.showProperties">

                    <label ng-show="properties == 'role' " class="col-xs-4 control-label">人数</label>
                    <div class="col-xs-offset-2 col-xs-3" ng-show="properties == 'role' ">
                        <input type="number" name="{{role.name}}" ng-show="properties == 'role' " onblur="checkRoleNum(this)" class="form-control roleItem" min="0" max="100" value="{{role.num}}" />
                    </div>
                     <span id="{{role.name}}" style="visibility: hidden" ng-show="properties == 'role' ">
                        error
                    </span>

                <div ng-show="properties != 'role' ">
                    <label  class="col-xs-4 control-label">{{properties}}</label>
                    <div class="col-xs-offset-2 col-xs-3">
                        <input type="text" name="{{role.name}}<-->{{properties}}" class="form-control" />
                    </div>

                </div>

            </div>
        </div>
    </form>
   <!-- <div class="text-center">
        <button class=" btn btn-primary">+</button>
    </div>
    -->
</div>
<nav class="navbar navbar-default navbar-fixed-bottom" role="navigation">
    <div class="navbar-header">
        <a class="btn btn-danger pull-left navbar-btn" href="../index.html" ng-click="gameExit()">结束游戏</a>
        <a class="btn btn-primary pull-right navbar-btn" ng-click="gameInit()"ng-href="gamePlay.html?gameid={{gameConfig.gameid}}">开始</a>

    </div>
</nav>
<script type="text/javascript" src="../js/framework/jquery/2.0.0/jquery.min.js"></script>
<script src="../js/framework/angular/angular.js"></script>
<script src="../js/framework/bootstrap/3.0.2/bootstrap.min.js"></script>
<script src="../js/game/config.js"></script>
<script src="../js/util/common_util.js"></script>
<script src="../js/game/game.js"></script>
<script>
    function checkRoleNum(role){
        var reg=new RegExp(/^\d{1,2}$/);
        var obj=document.getElementById(role.name);
        var num=parseInt(role.value);
        if(role){
            if(num > role.min && num < role.max && reg.test(role.value) ){
                obj.style.visibility = 'hidden';
                var items = document.getElementsByClassName("roleItem");
                var max = document.getElementsByName("maxPeople");
                var sum=0;
                if(role.name!="maxPeople"){

                    for(var i=0;i<items.length;i++){
                        if(items[i].style.display=='none')continue;
                        sum=sum+parseInt(items[i].value);
                    }
                   max[0].value=sum;
                }

            }else
                obj.style.visibility ='visible';
        }
    }

</script>
</body>
</html>